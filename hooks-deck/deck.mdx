import { CodeSurferColumnLayout, Step, Code } from "code-surfer";
export { vsDarkFull as theme } from "code-surfer/themes";
import { nightOwl as hooksTheme } from "code-surfer/themes";
import GreetingLoader from "./src/greeting-loader";
import { Image } from "mdx-deck";

This is a copy of [Dan's hooks demo](https://youtu.be/dpw9EHDh2bM?t=1051) from React Conf

I built it to test [Code Surfer v2](https://github.com/pomber/code-surfer/pull/58)

---

# Demo

---

<CodeSurferColumnLayout sizes={[1, 2]}>
  <Step subtitle="Here is a simple React component">
    <GreetingLoader />
    <Code
      code={require("!!raw-loader!./src/greeting.1.1.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="we want to make the 'name' editable">
    <GreetingLoader />
    <Code
      code={require("!!raw-loader!./src/greeting.1.1.js").default}
      lang="jsx"
      focus="7"
    />
  </Step>
  <Step subtitle="so we turn the component into a class">
    <GreetingLoader version="class.1.1" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.1.1.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="add some state">
    <GreetingLoader version="class.1.2" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.1.2.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="and add a change handler that calls setState">
    <GreetingLoader version="class.1.3" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.1.3.js").default}
      lang="jsx"
      focus="10:12,15:17,25"
    />
  </Step>
  <Step subtitle="we can now edit the name and it should work">
    <GreetingLoader version="class.1.3" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.1.3.js").default}
      lang="jsx"
      focus="1:31"
    />
  </Step>
</CodeSurferColumnLayout>

---

But let's take a step back

---

<CodeSurferColumnLayout sizes={[1, 2]} themes={[null, hooksTheme]}>
  <Step subtitle="what if we didn't have to write a class when we want to use state?">
    <GreetingLoader theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.1.1.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="we want to render an input with the name as the value">
    <GreetingLoader theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.1.1.js").default}
      focus="5,10"
      lang="jsx"
    />
  </Step>
  <Step subtitle="we don't know where to get name from, we'll fill it in later">
    <GreetingLoader theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.1.1.js").default}
      focus="5"
      lang="jsx"
    />
  </Step>
  <Step subtitle="we also need a way to update the name when the input changes">
    <GreetingLoader theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.1.2.js").default}
      focus="6,8:10,15[29:55]"
      lang="jsx"
    />
  </Step>
  <Step subtitle="name and setName are closely related, let's put them together">
    <GreetingLoader theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.1.2.js").default}
      focus="5:6"
      lang="jsx"
    />
  </Step>
  <Step subtitle="where do we get name and setName from?">
    <GreetingLoader theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.1.3.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="what if we could just **use** state from React?">
    <GreetingLoader version="hooks.1.4" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.1.4.js").default}
      focus="1[15:40],5"
      lang="jsx"
    />
  </Step>
</CodeSurferColumnLayout>

---

<CodeSurferColumnLayout themes={[null, hooksTheme]}>
  <Step>
    <Code
      code={require("!!raw-loader!./src/greeting.class.1.3.js").default}
      lang="jsx"
      title="Before Hooks"
      subtitle="A class component with state"
    />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.1.4.js").default}
      lang="jsx"
      title="After Hooks"
      subtitle="A function component with state"
    />
  </Step>
  <Step>
    <Code
      code={require("!!raw-loader!./src/greeting.class.1.3.js").default}
      lang="jsx"
      title="Before Hooks"
      subtitle="state has to be an object"
      focus="7:9"
    />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.1.4.js").default}
      lang="jsx"
      title="After Hooks"
      subtitle="state could be anything"
      focus="5"
    />
  </Step>
  <Step>
    <Code
      code={require("!!raw-loader!./src/greeting.class.1.3.js").default}
      lang="jsx"
      title="Before Hooks"
      subtitle="we read and update the state using this.state and this.setState"
      focus="7:12,16,24"
    />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.1.4.js").default}
      lang="jsx"
      title="After Hooks"
      subtitle="the state and the setter are just variables in the function"
      focus="5,8,14[16:27]"
    />
  </Step>
  <Step subtitle="What is useState exactly? useState is a hook, a function provided by React that lets you hook into React features from your function components">
    <Code
      code={require("!!raw-loader!./src/greeting.class.1.3.js").default}
      lang="jsx"
      title="Before Hooks"
      focus="1[100],31[100]"
    />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.1.4.js").default}
      lang="jsx"
      title="After Hooks"
      subtitle="just one line"
      focus="1[1:7,15:40],5"
    />
  </Step>
</CodeSurferColumnLayout>

---

<CodeSurferColumnLayout sizes={[1, 2]}>
  <Step subtitle="Now we want to add a second field for the surname">
    <GreetingLoader version="class.1.3" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.1.3.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="so we add another key to the state and copy all the boilerplate">
    <GreetingLoader version="class.2.1" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.2.1.js").default}
      lang="jsx"
    />
  </Step>
</CodeSurferColumnLayout>

---

<CodeSurferColumnLayout sizes={[1, 2]} themes={[null, hooksTheme]}>
  <Step subtitle="Let's do the same with hooks">
    <GreetingLoader version="hooks.1.4" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.1.4.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="we just declare a second state for surname and render it">
    <GreetingLoader version="hooks.2.1" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.2.1.js").default}
      lang="jsx"
    />
  </Step>
</CodeSurferColumnLayout>

---

<CodeSurferColumnLayout sizes={[1, 2]}>
  <Step subtitle="Let's read stuff from context">
    <GreetingLoader version="class.2.1" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.2.1.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="first we import the context from another file">
    <GreetingLoader version="class.3.1" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.3.1.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="we get the theme using the context render prop API">
    <GreetingLoader version="class.3.2" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.3.2.js").default}
      lang="jsx"
      focus="30,31,32[20:37],46,47"
    />
  </Step>
  <Step subtitle="and do the same with the locale">
    <GreetingLoader version="class.3.3" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.3.3.js").default}
      lang="jsx"
    />
  </Step>
</CodeSurferColumnLayout>

---

<CodeSurferColumnLayout sizes={[1, 2]} themes={[null, hooksTheme]}>
  <Step subtitle="How could we do the same with hooks?">
    <GreetingLoader version="hooks.2.1" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.2.1.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="we import useContext from React">
    <GreetingLoader version="hooks.3.1" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.3.1.js").default}
      lang="jsx"
      focus="1[27:37,40:52],3"
    />
  </Step>
  <Step subtitle="we can get the theme (and subscribe to updates) by just using the hook">
    <GreetingLoader version="hooks.3.2" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.3.2.js").default}
      lang="jsx"
      focus="8,19[14:30]"
    />
  </Step>
  <Step subtitle="">
    <GreetingLoader version="hooks.3.3" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.3.3.js").default}
      lang="jsx"
    />
  </Step>
</CodeSurferColumnLayout>

---

<CodeSurferColumnLayout themes={[null, hooksTheme]}>
  <Step subtitle="with the context hook we get rid of the render prop wrapper">
    <Code
      code={require("!!raw-loader!./src/greeting.class.3.3.js").default}
      lang="jsx"
      title="Before Hooks"
      focus="30,31,45,46,48,49,51,52"
    />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.3.3.js").default}
      lang="jsx"
      title="After Hooks"
      focus="8,9"
    />
  </Step>
</CodeSurferColumnLayout>

---

<CodeSurferColumnLayout sizes={[1, 2]}>
  <Step subtitle="Let's now update the document title using lifecycle methods">
    <GreetingLoader version="class.3.3" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.3.3.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="we do it by implementing componentDidMount and componentDidUpdate">
    <GreetingLoader version="class.4.1" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.4.1.js").default}
      lang="jsx"
    />
  </Step>
</CodeSurferColumnLayout>

---

<CodeSurferColumnLayout sizes={[1, 2]} themes={[null, hooksTheme]}>
  <Step subtitle="How do we do this with hooks?">
    <GreetingLoader version="hooks.3.3" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.3.3.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="we have the useEffect hook">
    <GreetingLoader version="hooks.4.1" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.4.1.js").default}
      lang="jsx"
      focus="1,4,5"
    />
  </Step>
  <Step subtitle="we pass a function that will run after every update and after the initial render">
    <GreetingLoader version="hooks.4.2" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.4.2.js").default}
      lang="jsx"
    />
  </Step>
</CodeSurferColumnLayout>

---

<CodeSurferColumnLayout themes={[null, hooksTheme]}>
  <Step>
    <Code
      code={require("!!raw-loader!./src/greeting.class.4.1.js").default}
      lang="jsx"
      title="Before Hooks"
      focus="20:28"
      subtitle="We have different lifecycle methods for mount and update"
    />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.4.2.js").default}
      lang="jsx"
      title="After Hooks"
      focus="15:17"
    />
  </Step>
  <Step>
    <Code
      code={require("!!raw-loader!./src/greeting.class.4.1.js").default}
      lang="jsx"
      title="Before Hooks"
      focus="20:28"
      subtitle="we use this.state to access state"
    />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.4.2.js").default}
      lang="jsx"
      title="After Hooks"
      focus="15:17"
      subtitle="the effect is inside the function component so we can use the variables from the function scope"
    />
  </Step>
</CodeSurferColumnLayout>

---

<CodeSurferColumnLayout sizes={[1, 2]}>
  <Step subtitle="Now we want to subscribe to the windows resize event">
    <GreetingLoader version="class.4.1" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.4.1.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="we add the window width to the state">
    <GreetingLoader version="class.5.1" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.5.1.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="add a row to render it">
    <GreetingLoader version="class.5.2" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.5.2.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="add a listener when the component mounts">
    <GreetingLoader version="class.5.3" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.5.3.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="and remove the listener before the component unmounts">
    <GreetingLoader version="class.5.4" />
    <Code
      code={require("!!raw-loader!./src/greeting.class.5.4.js").default}
      lang="jsx"
    />
  </Step>
</CodeSurferColumnLayout>

---

<CodeSurferColumnLayout sizes={[1, 2]} themes={[null, hooksTheme]}>
  <Step subtitle="Let's do the same with hooks">
    <GreetingLoader version="hooks.4.2" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.4.2.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="first we use a new state for the width">
    <GreetingLoader version="hooks.5.1" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.5.1.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="then we use a second effect for handling the resize">
    <GreetingLoader version="hooks.5.2" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.5.2.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="we can specify a clean up function, in the same effect, by returning it">
    <GreetingLoader version="hooks.5.3" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.5.3.js").default}
      lang="jsx"
      focus="20,23:26"
    />
  </Step>
</CodeSurferColumnLayout>

---

<CodeSurferColumnLayout themes={[null, hooksTheme]}>
  <Step>
    <Code
      code={require("!!raw-loader!./src/greeting.class.5.4.js").default}
      lang="jsx"
      title="Before Hooks"
      focus="22:35"
      subtitle="the logic for the different effects is mixed and splitted apart in different methods"
    />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.5.3.js").default}
      lang="jsx"
      title="After Hooks"
      focus="15:17,20:26"
      subtitle="the code is separated based on what is doing instead of when it runs"
    />
  </Step>
</CodeSurferColumnLayout>

---

<Image src="./onemorething.jpg" />

---

<CodeSurferColumnLayout sizes={[1, 2]} themes={[null, hooksTheme]}>
  <Step subtitle="this function is getting pretty large">
    <GreetingLoader version="hooks.5.3" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.5.3.js").default}
      lang="jsx"
      focus="1:51"
    />
  </Step>
  <Step subtitle="hook calls are just function calls">
    <GreetingLoader version="hooks.5.3" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.5.3.js").default}
      lang="jsx"
      focus="19:26"
    />
  </Step>
  <Step subtitle="so we can extract them">
    <GreetingLoader version="hooks.6.1" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.6.1.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="">
    <GreetingLoader version="hooks.6.2" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.6.2.js").default}
      lang="jsx"
    />
  </Step>
  <Step subtitle="we can also reduce duplication">
    <GreetingLoader version="hooks.6.2" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.6.2.js").default}
      lang="jsx"
      focus="10,11,17:23,28,31:34"
    />
  </Step>
  <Step subtitle="">
    <GreetingLoader version="hooks.6.3" theme={hooksTheme} />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.6.3.js").default}
      lang="jsx"
      focus="10,11,20,23,31:40"
    />
  </Step>
</CodeSurferColumnLayout>

---

<CodeSurferColumnLayout themes={[null, hooksTheme]}>
  <Step>
    <Code
      code={require("!!raw-loader!./src/greeting.class.5.4.js").default}
      lang="jsx"
      focus="5:77"
    />
    <Code
      code={require("!!raw-loader!./src/greeting.hooks.6.3.js").default}
      lang="jsx"
      focus="9:58"
    />
  </Step>
</CodeSurferColumnLayout>
